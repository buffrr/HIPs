<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width"><link rel=stylesheet href=https://hsd-dev.org/css/main.css><link rel=stylesheet href=https://hsd-dev.org/css/github-markdown.min.css><link rel=stylesheet href=/HIPs/css/style.css><title>DANE for Decentralized Naming Systems (dDANE) - Handshake Improvement Proposals</title><link rel=icon type=image/x-icon href=https://handshake.org/img/favicon/hns-favicon.ico><title>Handshake Improvement Proposals</title><meta name=title content="DANE for Decentralized Naming Systems (dDANE)"><meta name=description content="HIP-0007 - Category: Informational - Status: Draft"><meta name=author content="Matthew Zipkin (@pinheadmz)"><meta name=author content="Hasan Adams (@buffrr)"><meta property="og:type" content="website"><meta property="og:url" content="https://hsd-dev.org/HIPs/proposals/0007/"><meta property="og:title" content="DANE for Decentralized Naming Systems (dDANE)"><meta property="og:description" content="HIP-0007 - Category: Informational - Status: Draft"><meta property="og:image" content="https://hsd-dev.org/img/logo.svg"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://hsd-dev.org/HIPs/proposals/0007/"><meta property="twitter:title" content="DANE for Decentralized Naming Systems (dDANE)"><meta property="twitter:description" content="HIP-0007 - Category: Informational - Status: Draft"><meta property="twitter:image" content="https://hsd-dev.org/img/logo.svg"></head><body><header><a href=/><img alt="Handshake logo" src=https://hsd-dev.org/img/logo.svg></a></header><main><nav><div class=wrapper><ul><li><strong>HIPs</strong></li><li><a href=/>Home</a></li><li><a href=/HIPs/proposals/>Proposals</a></li><li><a href=https://t.me/hns_tech>Tech Chat</a></li></ul><ul><li><strong class=upper>category</strong></li><li class=capitalize><a href=https://hsd-dev.org/HIPs/category/informational>Informational</a></li><li class=capitalize><a href=https://hsd-dev.org/HIPs/category/standards>Standards</a></li><li class=capitalize><a href=https://hsd-dev.org/HIPs/category/standards-track>Standards track</a></li></ul><ul><li><strong class=upper>status</strong></li><li class=capitalize><a href=https://hsd-dev.org/HIPs/status/draft>Draft</a></li><li class=capitalize><a href=https://hsd-dev.org/HIPs/status/final>Final</a></li></ul></div></nav><article class=page><section class=markdown-body><h2>HIP-0007: DANE for Decentralized Naming Systems (dDANE)</h2><h2 id=abstract>Abstract</h2><p>ICANN-rooted DNS is not the only internet naming system available to users, but it
is the only naming system in which certificate authorities issue SSL certificates.
Since SSL certificates are the mechanism behind HTTPS, browsing securely to websites
outside the ICANN-rooted DNS is difficult and out of scope for the majority of users.</p><p>DANE is a protocol that uses DNSSEC to authenticate SSL certificates as presented by
a web server and could be used to bypass certificate authorities, assuming the naming
system is trusted or cryptographically secure.</p><p>DANE is an old innovation, initially proposed in 2012 in <a href=https://datatracker.ietf.org/doc/html/rfc6698>RFC6698</a> and updated in 2015
in <a href=https://datatracker.ietf.org/doc/html/rfc7671>RFC7671</a>. It has been met with consistent rejection, particularly from web browsers:
<a href=https://sockpuppet.org/blog/2015/01/15/against-dnssec/>1</a> <a href=https://sockpuppet.org/stuff/dnssec-qa.html>2</a> <a href=https://www.imperialviolet.org/2015/01/17/notdane.html>3</a> <a href="https://www.youtube.com/watch?v=Z-2cHpDPez8&t=1646s">4</a> The arguments against DANE/DNSSEC adoption by web browsers can be summarized
as follows:</p><ol><li>DNSSEC is unnecessary</li><li>DNSSEC is a government-controlled PKI</li><li>DNSSEC is cryptographically weak</li><li>DANE is slow</li></ol><p>Note that these widely-shared critiques are themselves over six years old, and there
is a new exciting technology that can breathe new life into the DANE use-case: BLOCKCHAIN.
In particular, there are many blockchain-based domain naming systems in production today,
including <a href=https://handshake.org/>Handshake</a>, <a href=https://www.namecoin.org/>Namecoin</a>, <a href=https://ens.domains/>Ethereum Name Service</a>, <a href=https://unstoppabledomains.com/>Unstoppable Domains</a>,
<a href=https://y.at/>yat</a>, and <a href=https://www.butterflyprotocol.io/>Butterfly Protocol</a>. <strong>Every single one of these domain name systems
needs DANE support in web browsers or their users will have no security. Without
convenient and secure web browsing accessible to the average user, none of these
systems will ever gain wide adoption.</strong></p><p>Decentralized, blockchain-based naming systems offer a brand new security model and
a brand new class of users and services, meaning that there is no &ldquo;legacy&rdquo; infrastructure
to update. If we establish a high-quality standard right now, there will be no
resistance from old systems that can refuse to upgrade, simply because there are no old
systems yet. Therefore:</p><ol><li>DNSSEC is necessary for DANE, which means secure browsing to websites hosted on
decentralized naming systems.</li><li>DNSSEC is not government-controlled if the domain name root zone is secured by a
decentralized consensus mechanism like <a href=https://bitcoin.org/bitcoin.pdf>proof-of-work</a>.</li><li>DNSSEC can be strong if all participants agree to require high-quality cryptosystems.</li><li>DANE is slow: decentralized systems are never convenient and there are difficult
trade-offs for adoption. Simple technology like caching can help improve this lag.</li></ol><h2 id=motivation>Motivation</h2><p>We propose a secure, simplified subset of the DANE protocol that can secure the
entire blockchain-naming ecosystem. Its properties are chosen to provide state-of-the-art
cryptographic security and limited flexibility to reduce the technical effort required
by web browsers to implement it.</p><h2 id=goals>Goals</h2><ol><li><p>Do not alter or affect in any way the resolution, authentication, or fetching
of ICANN-rooted domain names.</p></li><li><p>When browsing to a decentralized domain name, indicate to the user whether or not
the connection is secure (just like for legacy domains). A connection MUST
be indicated as secure ONLY if ALL requirements of the specification are satisfied.</p></li><li><p>Reduce the complexity (and increase the cryptographic security) of implementing
DANE in browsers by limiting available options.</p></li></ol><h2 id=specification>Specification</h2><h3 id=dns-resolution>DNS Resolution</h3><p>This protocol does not require that browsers resolve domain names internally, although
some networks like Handshake and Namecoin have embedable light clients: <a href=https://github.com/handshake-org/hnsd>hnsd</a> <a href=https://www.namecoin.org/docs/ncdns/>ncds</a>.
It is expected that users will already have their system configured to resolve names
by a trusted resolver (e.g. validating proof-of-work) that is either maintained by themselves
or optionally, by a browser vendor for public use. Such a resolver MUST verify DNSSEC
and ONLY set the DNS <code>ad</code> bit when DNSSEC is validated according to this specification.
If the <code>ad</code> bit is not set, the protocol has failed and the user should be alerted that
the connection is insecure. DNSSEC validity MUST be checked by the browser for the certificate matching record (<code>TLSA</code>).
No other DNS records need to be examined by the browser internally.</p><p><strong>We do not require the browser itself to resolve domain names or verify DNSSEC, we
only require it to check that an <code>ad</code> bit has been set on two queries (location and
certificate match).</strong></p><h3 id=root-ksk>Root KSK</h3><p>The security of &ldquo;legacy&rdquo; DNS, DNSSEC and DANE comes down to single key: ICANN&rsquo;s
<a href=https://www.iana.org/reports/2017/root-ksk-2017.pdf>KSK2017</a>. Since all decentralized naming systems replace this security model
with their own protocol, this key is not part of our system. However since we
want to approach DANE with as much legacy compatibility as possible, some kind of
root KSK must be trusted by the resolver that verifies DNSSEC.</p><p>For example, the Handshake full node reference implementation <a href=https://github.com/handshake-org/hsd>hsd</a> has a built-in
root authoritative name server which signs all requests with a &ldquo;public private key&rdquo;
(after verifying proof-of-work). This private key is hard-coded into the software
and because it is public, the user must have a secure connection with a trusted HNS
resolver.</p><p>That connection can be secured with:</p><ul><li><p>DNS-over-HTTPS: In this context, &ldquo;HTTPS&rdquo; relies entirely on legacy DNS and certificate
authority infrastructure and is therefore not recommended for decentralized naming systems,
despite the fact that it may be the most convenient method accessible to less advanced users.</p></li><li><p><code>SIG0</code>: To authenticate responses from a trusted resolver, the browser MUST allow
users to enter their resolver&rsquo;s public key. All Handshake full nodes generate a
public key for this function and that key can be fetched by the full node operator. This
is an example of an hsd node&rsquo;s URI containing it&rsquo;s <code>SIG0</code> public key and IP address:</p><p><code>aonetsezqp4m52w4jpfq2gv3dggy2wqfwqtkfjyttgdidbvhgp5as@165.22.151.242</code></p></li><li><p>Network firewall: if the browser is running on the same machine or local
network as the decentralized name resolver, an advanced user may choose to ignore <code>SIG0</code>
verification, although this is not recommended.</p></li></ul><h3 id=protocol>Protocol</h3><ol><li><p>When a user enters a URL into the browser, the software SHOULD first test the top-level
domain for inclusion in the current ICANN root zone. This is a very fast test, and can
be executed with a <a href=https://icann-tld-regexp.netlify.app/>regex</a> that the browser will only need to update a few times per year.
If the TLD is found in the current ICANN root zone, this protocol is aborted and the
browser should continue resolution and processing according to its &ldquo;legacy&rdquo; protocol.</p></li><li><p>For all other top-level-domains including names in the Handshake root zone, <code>.bit</code>
(Namecoin) or <code>.eth</code> (Ethereum Name Service), this protocol SHALL be applied and the
user should be alerted whether or not a connection is considered secure by these definitions.</p></li></ol><h3 id=dns-records>DNS Records</h3><p>DANE is defined by a series of DNS record types. We specify a limited set of options
for each record type to accomplish our goals. In particular, we limit algorithms
and hash functions:</p><p><strong>ALGO</strong>: Allowed signing algorithms</p><table><thead><tr><th>Value</th><th>Name</th></tr></thead><tbody><tr><td><code>8</code></td><td><code>RSASHA256</code></td></tr><tr><td><code>10</code></td><td><code>RSASHA512</code></td></tr><tr><td><code>13</code></td><td><code>ECDSAP256SHA256</code></td></tr><tr><td><code>15</code></td><td><code>ED25519</code></td></tr></tbody></table><p><strong>HASH</strong>: Allowed hash algorithms</p><table><thead><tr><th>Value</th><th>Name</th></tr></thead><tbody><tr><td><code>2</code></td><td><code>SHA256</code></td></tr><tr><td><code>5</code></td><td><code>SHA512</code></td></tr></tbody></table><p><strong>MATCH</strong>: Allowed matching algorithms</p><table><thead><tr><th>Value</th><th>Name</th></tr></thead><tbody><tr><td><code>1</code></td><td><code>SHA256</code></td></tr><tr><td><code>2</code></td><td><code>SHA512</code></td></tr></tbody></table><p>DS Records:</p><table><thead><tr><th>Field</th><th>Size</th><th>Allowed Values</th></tr></thead><tbody><tr><td>Key Tag</td><td>2 bytes</td><td></td></tr><tr><td>Algorithm</td><td>1 byte</td><td><strong>ALGO</strong></td></tr><tr><td>Digest Type</td><td>1 byte</td><td><strong>HASH</strong></td></tr><tr><td>Digest</td><td>var</td><td></td></tr></tbody></table><p>DNSKEY Records:</p><table><thead><tr><th>Field</th><th>Size</th><th>Allowed Values</th></tr></thead><tbody><tr><td>Flags</td><td>2 byte</td><td></td></tr><tr><td>Protocol</td><td>1 byte</td><td><code>3</code></td></tr><tr><td>Algorithm</td><td>1 byte</td><td><strong>ALGO</strong></td></tr><tr><td>Public Key</td><td>var</td><td></td></tr></tbody></table><p>TLSA Records:</p><table><thead><tr><th>Field</th><th>Size</th><th>Allowed Values</th></tr></thead><tbody><tr><td>Usage</td><td>1 byte</td><td><code>3</code> (<a href=https://datatracker.ietf.org/doc/html/rfc7671#section-5.1>DANE-EE</a>)</td></tr><tr><td>Selector</td><td>1 byte</td><td><code>1</code> (SubjectPublicKeyInfo)</td></tr><tr><td>Matching Type</td><td>1 byte</td><td><strong>MATCH</strong></td></tr><tr><td>Certificate</td><td>var</td><td></td></tr></tbody></table><hr><div class=info><strong>HIP:</strong><div>0007</div><strong>Status:</strong><div><a href=/status/draft>Draft</a></div><strong>Type:</strong><div><a href=/category/informational>Informational</a></div><strong>Created:</strong><div>Thu, 17 Jun 2021</div><strong>Last commit:</strong><div>Sun, 11 Sep 2022</div><strong>Authors:</strong><ul><li>Matthew Zipkin (@pinheadmz)</li><li>Hasan Adams (@buffrr)</li></ul></div><hr><a href=https://github.com/handshake-org/HIPs/blob/master/HIP-0007.md>Edit on GitHub</a></div></section><aside><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><a href=#abstract>Abstract</a></li><li><a href=#motivation>Motivation</a></li><li><a href=#goals>Goals</a></li><li><a href=#specification>Specification</a><ul><li><a href=#dns-resolution>DNS Resolution</a></li><li><a href=#root-ksk>Root KSK</a></li><li><a href=#protocol>Protocol</a></li><li><a href=#dns-records>DNS Records</a></li></ul></li></ul></nav></aside></article></main><footer id=footer>©&nbsp;2021 Handshake Community<a rel=license href=http://creativecommons.org/licenses/by-sa/4.0/>(Creative
Commons Attribution-ShareAlike 4.0 International License)</a></footer></body></html>